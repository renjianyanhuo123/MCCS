<UserControl x:Class="MCCS.Views.MethodManager.Contents.MethodWorkflowSettingPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MCCS.Views.MethodManager.Contents"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
             prism:ViewModelLocator.AutoWireViewModel="True"
             mc:Ignorable="d"
             xmlns:localViewModel="clr-namespace:MCCS.ViewModels.MethodManager.Contents"
             xmlns:workflowSetting="clr-namespace:MCCS.WorkflowSetting;assembly=MCCS.WorkflowSetting"
             xmlns:components="clr-namespace:MCCS.WorkflowSetting.Components;assembly=MCCS.WorkflowSetting"
             d:DesignHeight="450" d:DesignWidth="800" d:DataContext="{d:DesignInstance localViewModel:MethodWorkflowSettingPageViewModel}">
    <Grid x:Name="Container">
        <b:Interaction.Triggers>
            <b:EventTrigger EventName="Loaded">
                <b:InvokeCommandAction 
                    Command="{Binding LoadCommand}"
                    CommandParameter="{Binding ElementName=Container}"/>
            </b:EventTrigger>
        </b:Interaction.Triggers>
        <!-- 滚动区域 -->
        <ScrollViewer Name="CanvasScrollViewer"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto" 
                      Background="LightGray"> 
            <!-- Canvas with Scale/Translate transforms for zoom/pan -->
            <Grid x:Name="WorkflowCanvas" Width="{Binding Width}" 
                  Height="{Binding Height}"
                  Background="White"
                  RenderTransformOrigin="0.5,0.5">
                <Grid.RenderTransform>
                    <ScaleTransform ScaleX="{Binding Scale}" 
                                    ScaleY="{Binding Scale}" />
                </Grid.RenderTransform>
                <components:WorkflowStepListNodes DataContext="{Binding WorkflowNodes}">

                </components:WorkflowStepListNodes>
            </Grid>
        </ScrollViewer>

        <!-- 固定在顶部的工具栏（覆盖在 ScrollViewer 上方） -->
        <StackPanel VerticalAlignment="Top"
                    Opacity="0.9"
                    Background="White"
                    Orientation="Horizontal"
                    Panel.ZIndex="999">
            <materialDesign:NumericUpDown 
                Margin="30,10,10,10" 
                materialDesign:TextFieldAssist.SuffixText="%" 
                Value="{Binding Perect}" 
                Maximum="100"
                Minimum="0"
                x:Name="ScaleSlider" />
        </StackPanel>
    </Grid>
</UserControl>
