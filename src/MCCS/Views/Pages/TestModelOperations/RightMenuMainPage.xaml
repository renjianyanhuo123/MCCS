<UserControl x:Class="MCCS.Views.Pages.TestModelOperations.RightMenuMainPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MCCS.Views.Pages.TestModelOperations"
             xmlns:prism="http://prismlibrary.com/"
             prism:ViewModelLocator.AutoWireViewModel="True"
             mc:Ignorable="d" 
             xmlns:localView="clr-namespace:MCCS.ViewModels.Pages.TestModelOperations"
             xmlns:testStarting="clr-namespace:MCCS.Converters.TestStarting"
             xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
             d:DesignHeight="450" d:DesignWidth="800" d:DataContext="{d:DesignInstance localView:RightMenuMainPageViewModel}">
    <UserControl.Resources>
        <!-- 菜单项样式 -->
        <Style x:Key="CustomMenuItemStyle" TargetType="Border">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F0F0F0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- 禁用菜单项样式 -->
        <Style x:Key="DisabledMenuItemStyle" TargetType="Border">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- 分割线样式 -->
        <Style x:Key="MenuSeparatorStyle" TargetType="Rectangle">
            <Setter Property="Height" Value="1"/>
            <Setter Property="Fill" Value="#E0E0E0"/>
            <Setter Property="Margin" Value="0,4"/>
        </Style>

        <!-- VIP标签样式 -->
        <Style x:Key="VipLabelStyle" TargetType="Border">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#FF6B35" Offset="0"/>
                        <GradientStop Color="#FF8E35" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="CornerRadius" Value="3"/>
            <Setter Property="Padding" Value="6,2"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
        </Style>

        <!-- 箭头样式 -->
        <Style x:Key="ArrowStyle" TargetType="Path">
            <Setter Property="Data" Value="M0,0 L4,3 L0,6 Z"/>
            <Setter Property="Fill" Value="#999999"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="8,0"/>
        </Style>

        <!-- 阴影效果 -->
        <DropShadowEffect x:Key="MenuShadow" 
                          BlurRadius="16" 
                          ShadowDepth="4" 
                          Color="Black" 
                          Opacity="0.15"/>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"></BooleanToVisibilityConverter>
        <testStarting:InverseBoolToVisibleConverter x:Key="InverseBoolToVisibleConverter" />
    </UserControl.Resources>
    <Grid>
        <!-- 主菜单 -->
        <Border x:Name="MainMenuBorder"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="6"
                MinWidth="200"
                Effect="{StaticResource MenuShadow}">

            <StackPanel Margin="0,4"> 
                <!-- 打开阀门 -->
                <Border x:Name="OpenValveItem" Style="{StaticResource CustomMenuItemStyle}" Tag="打开阀门"
                        Visibility="{Binding IsOpen, Converter={StaticResource InverseBoolToVisibleConverter}}">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="MouseLeftButtonDown">
                            <b:InvokeCommandAction 
                                Command="{Binding OperationValveCommand}"
                                CommandParameter="True"/>
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                    <TextBlock Margin="12,0"  Text="打开阀门" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                </Border>
                <!-- 关闭阀门 -->
                <Border x:Name="CloseValveItem" Style="{StaticResource CustomMenuItemStyle}" 
                        Visibility="{Binding IsOpen, Converter={StaticResource BooleanToVisibilityConverter}}" 
                        Tag="关闭阀门">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="MouseLeftButtonDown">
                            <b:InvokeCommandAction 
                                Command="{Binding OperationValveCommand}"
                                CommandParameter="False"/>
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                    <TextBlock  Margin="12,0"  Text="关闭阀门" VerticalAlignment="Center" FontSize="14" Foreground="#333" />
                </Border>
                <!-- 分割线 -->
                <Rectangle Style="{StaticResource MenuSeparatorStyle}"/>
                <!-- 力清零 -->
                <Border x:Name="ForceClearZero" Style="{StaticResource CustomMenuItemStyle}"   Tag="力清零">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="MouseLeftButtonDown">
                            <b:InvokeCommandAction 
                                Command="{Binding ForceTareCommand}"
                                CommandParameter="False"/>
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                    <TextBlock Margin="12,0" Text="力清零" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                </Border>
                <!-- 位移清零 -->
                <Border x:Name="PositionClearZero" Style="{StaticResource CustomMenuItemStyle}"   Tag="位移清零">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="MouseLeftButtonDown">
                            <b:InvokeCommandAction 
                                Command="{Binding PositionTareCommand}"
                                CommandParameter="False"/>
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                    <TextBlock Margin="12,0" Text="位移清零" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                </Border>
                <!-- 分割线 -->
                <Rectangle Style="{StaticResource MenuSeparatorStyle}"/>

                <!-- 查看网页源码 -->
                <Border x:Name="ViewSourceItem" Style="{StaticResource CustomMenuItemStyle}"  Tag="查看网页源码">
                    <Grid Margin="12,0">
                        <TextBlock Text="查看网页源码" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                    </Grid>
                </Border>

                <!-- 分割线 -->
                <Rectangle Style="{StaticResource MenuSeparatorStyle}"/>

                <!-- 全屏 -->
                <Border x:Name="FullScreenItem" Style="{StaticResource CustomMenuItemStyle}"   Tag="全屏">
                    <Grid Margin="12,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="全屏" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                        <TextBlock Grid.Column="1" Text="Ctrl+A" VerticalAlignment="Center" FontSize="12" Foreground="#999" Margin="24,0,0,0"/>
                    </Grid>
                </Border>

                <!-- 创建连接 -->
                <Border x:Name="CreateLinkItem" Style="{StaticResource CustomMenuItemStyle}"  Tag="创建连接">
                    <Grid Margin="12,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="创建连接" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                        <TextBlock Grid.Column="1" Text="L" VerticalAlignment="Center" FontSize="12" Foreground="#999" Margin="24,0,0,0"/>
                    </Grid>
                </Border>

                <!-- 插入图片 -->
                <Border x:Name="InsertImageItem" Style="{StaticResource CustomMenuItemStyle}"  Tag="插入图片">
                    <Grid Margin="12,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="插入图片" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                        <TextBlock Grid.Column="1" Text="I" VerticalAlignment="Center" FontSize="12" Foreground="#999" Margin="24,0,0,0"/>
                    </Grid>
                </Border>

                <!-- Mermaid绘图 -->
                <Border x:Name="MermaidItem" Style="{StaticResource CustomMenuItemStyle}"   Tag="Mermaid绘图">
                    <Grid Margin="12,0">
                        <TextBlock Text="Mermaid绘图" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                    </Grid>
                </Border>

                <!-- 网络复用 - 带子菜单 -->
                <Border x:Name="NetworkMenuItem" Style="{StaticResource CustomMenuItemStyle}"  >
                    <Grid Margin="12,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="网络复用" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                        <Path Grid.Column="1" Style="{StaticResource ArrowStyle}"/>
                    </Grid>
                </Border>

            </StackPanel>
        </Border>

        <!-- 二级菜单 -->
        <Popup x:Name="SubMenuPopup" 
               PlacementTarget="{Binding ElementName=NetworkMenuItem}"
               Placement="Right"
               AllowsTransparency="True"
               StaysOpen="False" >

            <Border Background="White"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1"
                    CornerRadius="6"
                    MinWidth="160"
                    Effect="{StaticResource MenuShadow}">

                <StackPanel Margin="0,4">

                    <!-- 复制网页 - 带VIP标签 -->
                    <Border x:Name="CopyWebItem" Style="{StaticResource CustomMenuItemStyle}"   Tag="复制网页">
                        <Grid Margin="12,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="复制网页" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                                <Border Style="{StaticResource VipLabelStyle}">
                                    <TextBlock Text="VIP" 
                                             Foreground="White" 
                                             FontSize="10" 
                                             FontWeight="Bold"/>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- 站点访问 -->
                    <Border x:Name="SiteAccessItem" Style="{StaticResource CustomMenuItemStyle}"   Tag="站点访问">
                        <Grid Margin="12,0">
                            <TextBlock Text="站点访问" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                        </Grid>
                    </Border>

                    <!-- 分割线 -->
                    <Rectangle Style="{StaticResource MenuSeparatorStyle}"/>

                    <!-- 网络设置 -->
                    <Border x:Name="NetworkSettingsItem" Style="{StaticResource CustomMenuItemStyle}"   Tag="网络设置">
                        <Grid Margin="12,0">
                            <TextBlock Text="网络设置" VerticalAlignment="Center" FontSize="14" Foreground="#333"/>
                        </Grid>
                    </Border>

                    <!-- 高级选项 - 禁用状态 -->
                    <Border x:Name="AdvancedOptionsItem" Style="{StaticResource DisabledMenuItemStyle}">
                        <Grid Margin="12,0">
                            <TextBlock Text="高级选项" VerticalAlignment="Center" FontSize="14" Foreground="#999"/>
                        </Grid>
                    </Border>

                </StackPanel>
            </Border>
        </Popup>

    </Grid>
</UserControl>
